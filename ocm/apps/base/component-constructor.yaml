# yaml-language-server: $schema= https://ocm.software/schemas/configuration-schema.yaml
# https://ocm.software/docs/tutorials/input-and-access-types/
components:
  - name: opendesk.ocm-k8s-toolkit.sap.com/base
    version: "${artifactVersion}"
    provider:
      name: Open-Desk

    resources:
      ################## converge cloud core infrastructure ##################
      - name: k8s-manifests
        type: blob
        input:
          type: dir
          path: ./../../k8s-manifests

      - name: helm-chart-ingress-nginx
        type: helmChart
        version: "4.11.6"
        access:
          type: helm
          helmChart: ingress-nginx:4.11.6
          helmRepository: https://kubernetes.github.io/ingress-nginx

      - name: image-ingress-nginx
        type: ociImage
        version: "1.12.2"
        access:
          type: ociArtifact
          imageReference: https://registry.k8s.io/ingress-nginx/controller:v1.12.2

      - name: helm-chart-cert-manager
        type: helmChart
        version: "4.11.6"
        access:
          type: helm
          helmChart: cert-manager:1.17.2
          helmRepository: https://charts.jetstack.io

      - name: opendesk-values-configmap
        type: ociImage
        version: ${artifactVersion}
        access:
           type: ociArtifact
           imageReference: oci://ghcr.io/${repository}/opendesk-ocm-k8s-toolkit-values-configmaps:${artifactVersion}
     
    componentReferences:
      - name: opendesk-services
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/opendesk-services
        # exact version will be set after other component-constructors have been transfered & published
        version: ${artifactVersion}
      - name: services-external
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/services-external
        version: ${artifactVersion}
      - name: open-xchange
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/open-xchange
        version: ${artifactVersion}
      - name: nextcloud
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/nextcloud
        version: ${artifactVersion}
      - name: collabora
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/collabora
        version: ${artifactVersion}
      - name: cryptpad
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/cryptpad
        version: ${artifactVersion}
      - name: jitsi
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/jitsi
        version: ${artifactVersion}
      - name: element
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/element
        version: ${artifactVersion}
      - name: openproject
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/openproject
        version: ${artifactVersion}
      - name: xwiki
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/xwiki
        version: ${artifactVersion}
      - name: opendesk-openproject-bootstrap
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/opendesk-openproject-bootstrap
        version: ${artifactVersion}
      - name: opendesk-migrations-post
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/opendesk-migrations-post
        version: ${artifactVersion}
      - name: notes
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/notes
        version: ${artifactVersion}
      - name: nubus
        componentName: opendesk.poc-ocm-k8s-toolkit.sap.com/nubus
        version: ${artifactVersion}
